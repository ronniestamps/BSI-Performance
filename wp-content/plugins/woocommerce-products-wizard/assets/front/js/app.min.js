var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module&&"function"==typeof require?module.exports=e(require("jquery")):e(t.jQuery)}(this,function(t){"use strict";function e(){return t('[data-component="wcpw"]').each(function(){t(this).wcProductsWizard()})}var n={},o=window.wordpressAjaxUrl||"/wp-admin/admin-ajax.php",i=function(e,o){this.element=e,this.options=t.extend({},n,o),this.init()};i.prototype.init=function(){var e=this;return e.$element=t(e.element),e.$element.on("click",'[data-component="wcpw-form-item"]',function(){return t(this).find('[data-component="wcpw-form-item-id"][type="radio"]').prop("checked",!0)}).on("click",'[data-component="wcpw-add-to-cart"]',function(n){return n.preventDefault(),e.addToMainCart(t(this))}).on("click",'[data-component="wcpw-form-item-remove-from-cart"]',function(n){n.preventDefault();var o=t(this),i=o.parents('[data-component="wcpw-form"]');return e.removeItem({itemId:o.data("item-id"),page:i.data("page"),stepId:i.data("step-id")})}).on("click",'[data-component="wcpw-form-item-add-to-cart"]',function(n){n.preventDefault();var o=t(this),i=o.parents('[data-component="wcpw-form"]');return e.addItem({itemId:o.data("item-id"),page:i.data("page"),stepId:i.data("step-id")})}).on("click",'[data-component~="wcpw-nav-item"]',function(n){n.preventDefault();var o=t(this);return e.navRouter({action:o.data("nav-action"),stepId:o.data("nav-id")})}).on("click",'[data-component="wcpw-form-pagination-link"]',function(n){n.preventDefault();var o=t(this);return e.navRouter({action:"get",stepId:o.data("step-id"),page:o.data("page")})}),t(document).trigger("launched.wcProductsWizard",e),e},i.prototype.ajaxRequest=function(e){var n=this,i=n.$element.find(".active.step-block").innerWidth()+n.$element.find(".active.step-block").prev().innerWidth()+3,r=n.$element.find(".active.step-block").innerHeight()+n.$element.find(".active.step-block").prev().innerHeight()+2;return n.$element.addClass("loading"),e.id=n.$element.data("id"),t.post(o,e,function(o){return n.$element.html(o.content).removeClass("loading").find(".builder-frame").addClass("fadeInLeft animated"),e.hasOwnProperty("stepId")||(t(window).width()>991?n.$element.find(".steps").animate({scrollTop:r+"px"},800):n.$element.find(".steps").animate({scrollLeft:i+"px"},800)),t(document).trigger("ajaxCompleted.wcProductsWizard",n),n},"json")},i.prototype.navRouter=function(t){var e={stepId:t.stepId,page:t.page||1};switch(t.action){case"get":return this.getStep(e);case"skip":return this.skipStep();case"skip-all":return this.skipAll(e);case"submit":return this.submitStep();case"reset":return this.reset();case"none":break;default:return this.getStep(e)}},i.prototype.getProductsToAdd=function(){var e=this,n=this.$element.find('[data-component="wcpw-form-item-id"]:checked'),o=[];return n.each(function(){var n=e.getProductToAdd({id:t(this).val()});if(n)return o.push(n)}),o},i.prototype.getProductToAdd=function(e){var n=this,o=n.$element.find('[data-component="wcpw-form-item"][data-id="'+e.id+'"]'),i=o.find('[data-component="wcpw-form-item-id"]'),r=(o.find('[data-component="wcpw-form-item-variations-attributes"]'),o.find('[data-component="wcpw-form-item-variations-attributes-item-value"]')),a=o.find('[data-component="wcpw-form-item-quantity"]').find(':input:not([type="button"])').val()||1,d=!0;return r.filter('[type="radio"]').length&&0===r.filter('[type="radio"]:checked').length&&(d=!1),"variable"!==o.attr("data-type")||o.find('[data-component="wcpw-form-item-variations-variation-id"]').val()&&d?{product_id:i.val(),variation_id:o.find('[data-component="wcpw-form-item-variations-variation-id"]').val(),variation:t.param(o.find('[data-component="wcpw-form-item-variations-attributes"]').find("select, input").serializeArray()),quantity:a}:(t(document).trigger("noProductVariationSelected.error.wcProductsWizard",{instance:n,$attributesItemValue:r}),!1)},i.prototype.removeItem=function(e){return this.ajaxRequest(t.extend({action:"removeWoocommerceProductsWizardCartItem"},e))},i.prototype.addItem=function(e){var n=this.getProductToAdd({id:e.itemId});return!!n&&this.ajaxRequest(t.extend({action:"addWoocommerceProductsWizardItemToCart",productsToAdd:[n]},e))},i.prototype.submitStep=function(){var e=this.$element.find('[data-component="wcpw-form"]').data("step-id"),n=this.getProductsToAdd(),o=this.$element.find('[data-component="wcpw-form-minimum-products-to-add"]').val(),i=this.$element.find('[data-component="wcpw-js-data"]').data("cart-steps-items"),r=i[e]||[],a=[];return n.forEach(function(t){return a.push(t.product_id)}),r=r.concat(a).filter(function(t,e,n){return e==n.indexOf(t)}),r.length<o?(t(document).trigger("minimumItemsRequired.error.wcProductsWizard",{instance:this}),!1):this.ajaxRequest({action:"submitWoocommerceProductsWizardForm",productsToAdd:n})},i.prototype.addToMainCart=function(e,n){var i=this.$element.find("#"+e.attr("form")).serialize();return t(".builder-sidebar").addClass("loading"),e.data("meet-minimum-products-to-add")?t.post(o,i,function(){t(".builder-sidebar").removeClass("loading"),t("#floating-shopping-cart").modal("show")},"json"):(t(document).trigger("minimumItemsRequired.error.wcProductsWizard",{instance:this,stepId:e.data("step-id")}),!1)},i.prototype.skipStep=function(){return this.ajaxRequest({action:"skipWoocommerceProductsWizardForm"})},i.prototype.skipAll=function(e){return this.ajaxRequest(t.extend({action:"skipAllWoocommerceProductsWizardForm"},e))},i.prototype.getStep=function(e){return this.ajaxRequest(t.extend({action:"getWoocommerceProductsWizardForm"},e))},i.prototype.reset=function(){return this.ajaxRequest({action:"resetWoocommerceProductsWizardForm"})},t.fn.wcProductsWizard=function(e){return this.each(function(){t.data(this,"plugin_wcProductsWizard")||t.data(this,"plugin_wcProductsWizard",new i(this,e))})},t(document).ready(function(){return e()}).on("init.wcProductsWizard",function(){return e()})});